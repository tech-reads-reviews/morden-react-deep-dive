# 4장: 서버 사이드 렌더링

## 1. 서버 사이드 렌더링이란?

> 서버 사이드 렌더링(Server-Side Rendering, SSR)은 웹 페이지의 HTML 콘텐츠를 사용자 요청 시마다 서버에서 생성하여 클라이언트에 전달하는 기술이다.

서버 사이드 렌더링이란? SSR을 구현하는 것은 SPA를 만드는 것보다 신경쓸 점이 많음. 현재 웹의 상황과, 왜 SSR을 사용해야 하는지 먼저 살펴보자

1. SPA의 세상 SPA -> 렌더링과 라우팅에 필요한 대부분의 기능을 서버가 아닌 브라우저의 JS에 의존 SPA의 HTML 코드에 body 내부 아무것도 없는 이유 -> JS로 삽입한 뒤 렌더링하기 때문전통적인 서버 사이드 작동 앱은 -> HTML 페이지를 다운로드하고 파싱하고...이런 작업들을 페이지가 바뀔 때마다 거침이걸 JS로 진행할 경우 최초에 한번 모든 리소스를 다운로드하고 나면 이후 페이지를 전환할 때 추가로 리소스를 다운로드하는 시간이 필요 없어짐. MVx 프레임워크에 대해 간단하게 알아보기발전된 웹 환경과 기기, 하지만 속도는?
2. SSR이란? 최초에 사용자에게 보여줄 페이지를 서버에서 렌더링해 빠르게 제공장점최초 페이지 진입이 비교적 빠름검색 엔진과 SNS 공유 등 메타데이터 제공이 쉬움누적 레이아웃 이동이 적음사용자의 디바이스 성능으로부터 비교적 자유로움보안에 조금 더 안전함단점소스코드를 작성할 때 항상 서버를 고려해야함적절한 서버가 구축되어 있어야 함서비스 지연에 따른 문제
3. SPA와 SSR을 모두 알아야 하는 이유 SSR은 만능이 아니다잘못된 웹페이지 설계는 오히려 독이 될 수 있다. 웹페이지의 설계와 목적, 우선순위에 따라 SPA가 더 효율적일수도 있다. SPA와 SSR 앱가장 뛰어난 SPA는 가장 뛰어난 MPA보다 낫다평균적인 SPA는 평균적인 MPA보다 느리다 Paint Holding back forward cache Shared Element Transitions 현대의 SSR 기존의 LAMP 스택과는 조금 다름최초 웹사이트 진입시 -> SSR로 완성된 HTML을 제공받음이후 라우팅 -> 서버에서 내려받은 JS를 바탕으로 SPA처럼 동작

## 2. 서버 사이드 렌더링을 위한 리액트 API 살펴보기

### 1. renderToString

- 리액트에서는 앱을 서버에서 렌더링할 수 있는 API도 제공.
- renderToString
  - 인수로 넘겨받은 컴포넌트를 렌더링해 HTML 문자열로 반환하는 함수
  - 렌더링되는 컴포넌트 내부의 hook과 이벤트 핸들러는 포함되지 않음 (빠른 렌더링을 위한 HTML 제공이 목적이기 때문)
- renderToStaticMarkup
  - renderToString과 비슷하지만, React에서만 사용하는 데이터 속성이 없음
  - hydrate를 수행하지 않는 순수한 결과물(정적인 경우에 유용)
- renderToNodeStream
  - renderToString과 완전히 동일하지만 차이점
  - 브라우저에서 사용하는 것이 완전 불가 (노드환경에 의존)
  - 결과물의 타입이 ReadableStream
  - 스트림은 데이터를 청크 단위로 쪼개서 가져오는 것
- renderToStaticNodeStream
  - renderToString - renderToStaticMarkup의 관계와 비슷
  - 즉, hydrate가 불필요한 순수 HTML 결과물이 필요할때
- hydrate
  - HTML 콘텐츠에 JS 핸들러나 이벤트를 붙이는 역할
  - 이와 비슷한 브라우저에서만 사용되는 render라는 메서드가 있음
  - hydrate는 단순히 이벤트 핸들러를 추가하느 ㄴ것 이외에도 렌더링을 한번 더 수행하면서 hydrate가 수행한 렌더링 결과물 HTML과 인수로 넘겨받은 HTML을 비교하는 작업을 수행함

### 서버 사이드 렌더링 예제 프로젝트

어떤 식으로 코드가 구성되어 있는지서버와 클라이언트(브라우저)가 어떻게 분리되어 있는지

## 3. Next.js란?

풀택 웹 앱을 구축하기 위한 리액트 기반 프레임워크
